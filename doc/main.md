# 数据查询工具产品文档

# 数据查询与二维码生成工具 - 产品文档（Cursor 兼容版）
## 一、BRD（商业需求文档）
### 1. 文档基本信息
| 项目名称 | Windows 数据查询与二维码生成工具 |
| ---- | ---- |
| 文档版本 | V1.0 |
| 编制日期 | 2025-11-03 |
| 编制人 | 产品团队 |
| 适用范围 | 工具开发团队、测试团队、需求方 |

### 2. 项目背景
需求方拥有数十万份数据文件（支持 CSV、XLSX、XLS 格式），每份文件中每行为一条"数据链"（含指定数字与关联链接）。当前无高效查询工具，无法快速匹配数字与链接并转二维码，且无法追溯查询记录、核销状态及时间，导致数据使用效率低、追溯性差。

### 3. 业务目标
1. 实现数十万数据文件（CSV、XLSX、XLS 格式）中"指定数字 - 关联链接"的快速查询，响应高效、结果准确。
2. 自动将查询到的链接生成可识别二维码，支持保存。
3. 记录查询行为，统计查询次数，实现追溯。
4. 支持“核销”操作（仅1次有效），记录核销状态与时间，避免重复核销。

### 4. 目标用户
需求方内部人员（数据管理、业务操作），核心诉求为“查询 - 生成 - 追溯 - 核销”一体化。

### 5. 核心价值
- 效率提升：替代人工翻阅，实现秒级查询与二维码生成。
- 数据可控：全流程追溯查询与核销，避免重复操作。
- 操作便捷：可视化界面，无专业技术门槛。

### 6. 业务约束
1. 仅支持 Windows 10 及以上版本（32/64 位）。
2. 数据文件需符合"指定数字 + 关联链接"结构化格式，支持 CSV、XLSX、XLS 格式（CSV 分隔符可配置：逗号、制表符等）。
3. 核销操作不可逆，一旦标记"已核销"无法二次操作。
4. 支持数十万级数据文件解析，无性能卡顿。

### 7. 成功指标
- 查询响应时间 ≤ 3 秒（单条）。
- 二维码生成准确率 100%。
- 查询/核销记录准确率 100%。
- 工具运行稳定，无崩溃、数据丢失。

---

## 二、PRD（产品需求文档）
### 1. 文档基本信息
| 项目名称 | Windows 数据查询与二维码生成工具 |
| ---- | ---- |
| 文档版本 | V1.0 |
| 编制日期 | 2025-11-03 |
| 编制人 | 产品团队 |
| 依赖文档 | BRD（商业需求文档） |

### 2. 产品概述
Windows 桌面工具，支持加载指定文件夹下的数据文件（CSV、XLSX、XLS 格式），通过"指定数字"查询关联链接并自动生成二维码，展示查询次数、核销状态及时间，支持"确认核销"（仅1次），实现一体化功能。

### 3. 核心功能需求
#### 3.1 文件夹加载功能
1. 支持用户选择本地文件夹，自动扫描加载所有数据文件（支持格式：CSV、XLSX、XLS）。
2. 文件格式校验：
   - **CSV 格式**：每行需含"指定数字 + 关联链接"，分隔符默认支持逗号、制表符、分号，可配置；支持带表头或无表头模式。
   - **XLSX/XLS 格式**：读取第一个工作表（Sheet1），每行需含两列数据（第一列为指定数字，第二列为关联链接）；支持从第一行或第二行开始读取（跳过表头）。
   - 格式错误或无法解析的文件提示"XX 文件异常，已跳过"。
3. 加载完成提示"加载成功：X 个数据文件，Y 条数据"。
4. 支持重新加载（重选文件夹/刷新数据）。

#### 3.2 数据查询功能
1. 提供查询输入框（支持数字/字母，区分大小写），回车或“查询”按钮触发查询。
2. 查询逻辑：匹配“指定数字”，存在则返回唯一链接（重复数据提示“重复，返回第一条”）；无匹配提示“未查询到数据”。
3. 响应时间 ≤ 3 秒（数据量 ≤ 100 万条）。
4. 每次查询成功，自动累加该数字的查询次数（初始为 0）。

#### 3.3 二维码生成功能
1. 查询成功后，自动生成二维码（默认 200*200px），支持右键保存为 PNG 格式。
2. 二维码需可识别，扫描后跳转至关联链接。
3. 查询失败时，二维码区域显示“无对应二维码”。

#### 3.4 状态展示功能
1. 查询成功后，展示以下信息：
   - 关联链接：完整显示，支持一键复制。
   - 查询次数：“第 X 次查询”（加粗）。
   - 核销状态：“未核销”（灰色）/“已核销”（绿色）。
   - 核销时间：“--”（未核销）/“YYYY-MM-DD HH:MM:SS”（已核销）。
2. 查询失败时，所有字段显示“--”，仅保留失败提示。

#### 3.5 核销操作功能
1. 仅“查询成功且未核销”时，“确认核销”按钮可点击；其他场景置灰。
2. 点击后弹出二次确认：“是否确认核销？不可撤销。”，确认后执行操作。
3. 核销后：状态更新为“已核销”，记录当前系统时间，按钮永久置灰。
4. 核销/查询记录本地持久化，重启工具不丢失。

#### 3.6 历史记录功能
1. 展示最近 100 条查询记录，含“查询时间、指定数字、查询结果、核销状态”。
2. 支持“重新查询”（直接触发该数字查询）、“清除记录”（单条删除/批量清空）。

### 4. 非功能需求
#### 4.1 性能需求
1. 支持加载数据量 ≤ 100 万条，加载时间 ≤ 10 秒（取决于硬件）。
2. 单条查询响应 ≤ 3 秒，连续 10 次查询无卡顿。
3. 二维码生成时间 ≤ 1 秒。

#### 4.2 兼容性需求
1. 兼容 Windows 10 及以上版本（32/64 位）。
2. 支持文件格式及编码：
   - **CSV 格式**：支持 UTF-8、GBK、ANSI 编码。
   - **XLSX/XLS 格式**：支持 Excel 2007 及以上版本（.xlsx）和 Excel 97-2003 版本（.xls）。

#### 4.3 易用性需求
1. 操作步骤 ≤ 3 步（加载文件夹 → 输入查询 → 查看/核销）。
2. 关键操作提供成功/失败提示。
3. 支持快捷键：查询（Ctrl+Enter）、复制链接（Ctrl+C）、保存二维码（Ctrl+S）。

#### 4.4 数据安全需求
1. 所有数据仅本地存储，不云端上传。
2. 本地存储路径可配置（默认：C:\Users\当前用户名\AppData\Roaming\DataQueryTool\Data），支持手动备份/删除。

### 5. 界面需求
1. 布局分区：文件夹配置区、查询操作区、结果展示区、历史记录区。
2. 分辨率适配：支持 1366*768 及以上，无元素遮挡。
3. 色彩风格：浅蓝/白色为主色调，关键按钮（查询、核销）深色突出，已核销状态绿色标识。

### 6. 错误处理需求
1. 无有效数据文件的文件夹：提示"所选文件夹无有效数据文件（支持 CSV、XLSX、XLS 格式）"。
2. 文件格式或编码错误：提示"XX 文件格式异常或编码不兼容，已跳过"。
3. 空输入查询：提示"请输入指定数字后查询"。
4. 系统时间异常：提示"系统时间异常，无法记录核销时间，请校准后重试"。
5. 异常崩溃：重启后自动恢复加载数据、查询/核销记录。

---

## 三、产品流程图（Mermaid 代码，可直接在 Cursor 中渲染）
```mermaid
graph TD
    A[启动工具] --> B[加载文件夹]
    B --> C{文件夹校验}
    C -->|无有效数据文件/格式错误| D[提示错误，重新选择文件夹]
    D --> B
    C -->|校验通过| E[加载数据完成，显示数据统计]
    E --> F[输入指定数字 + 点击查询/回车]
    F --> G{输入校验}
    G -->|输入为空| H[提示“请输入指定数字”]
    H --> F
    G -->|输入有效| I[查询匹配数据]
    I --> J{是否匹配成功}
    J -->|未匹配| K[显示“未查询到对应数据”，二维码区域为空]
    K --> F
    J -->|匹配成功| L[更新查询次数（+1）]
    L --> M[生成二维码 + 展示关联链接、查询次数、核销状态、核销时间]
    M --> N{是否点击“确认核销”}
    N -->|否/按钮置灰| O[可重新查询/查看历史记录]
    O --> F
    N -->|是（状态为未核销）| P[弹出二次确认弹窗]
    P --> Q{用户确认}
    Q -->|取消| M
    Q -->|确认| R[更新状态为“已核销”，记录当前时间，按钮置灰]
    R --> S[展示更新后的状态与时间]
    S --> O
    E --> T[查看历史记录]
    T --> U[选择记录：重新查询/删除]
    U -->|重新查询| F
    U -->|删除| V[移除该历史记录]
    V --> T
---

## 四、UI 原型描述（用于 Cursor 原型开发参考）

### 1. 整体窗口配置

| 配置项 | 说明 |
| ---- | ---- |
| **窗口尺寸** | 宽 800px，高 600px（固定，支持最大化） |
| **窗口样式** | Windows 标准桌面窗口，顶部含 "最小化 / 最大化 / 关闭" 按钮 |
| **标题栏** | 文字 "数据查询与二维码生成工具 V1.0"，居中，字体 16px 加粗，浅灰色背景 |

### 2. 分区详细设计

#### 2.1 文件夹配置区（上半部分左侧，宽 350px，高 80px，间距 10px）

| 元素 | 位置 | 样式 | 交互 |
| ---- | ---- | ---- | ---- |
| 标签 "数据文件夹：" | 左上角，距顶部 10px | 字体 14px，黑色 | 无 |
| 路径输入框 | 标签右侧，宽 220px，高 30px | 边框 1px 灰色，字体 12px | 不可手动输入，仅显示路径 |
| "选择文件夹" 按钮 | 输入框右侧，宽 100px，高 30px | 浅蓝底色（#4A90E2），白色字体 13px，圆角 3px | 点击弹出本地文件夹选择框 |
| "重新加载" 按钮 | 输入框下方，距输入框 10px | 浅灰底色（#E0E0E0），黑色字体 13px，圆角 3px | 点击刷新当前文件夹数据 |
| 加载提示 | 重新加载按钮下方 | 字体 12px，灰色 | 加载中显示 "加载中..."，完成显示 "X 个文件，Y 条数据" |

#### 2.2 查询操作区（上半部分右侧，宽 400px，高 80px，间距 10px）

| 元素 | 位置 | 样式 | 交互 |
| ---- | ---- | ---- | ---- |
| 标签 "指定数字查询：" | 左上角，距顶部 10px | 字体 14px，黑色 | 无 |
| 查询输入框 | 标签右侧，宽 280px，高 30px | 边框 1px 灰色，字体 12px | 支持输入数字 / 字母，区分大小写 |
| "查询" 按钮 | 输入框右侧，宽 80px，高 30px | 深蓝底色（#2C3E50），白色字体 13px，圆角 3px | 点击触发查询；输入为空时点击提示错误 |

#### 2.3 结果展示区（中间部分，宽 800px，高 250px，边框 1px 灰色，间距 15px）

##### 子区域 1（左侧：二维码展示区）

| 配置项 | 说明 |
| ---- | ---- |
| **尺寸** | 200*200px，居中，边框 1px 灰色 |
| **内容** | 查询成功显示二维码，失败显示 "无对应二维码"（字体 12px，灰色，居中） |
| **交互** | 右键点击弹出 "保存图片" 选项，保存格式为 PNG |

##### 子区域 2（右侧：信息展示区，宽 550px，高 250px，间距 10px）

| 元素 | 位置 | 样式 | 交互 |
| ---- | ---- | ---- | ---- |
| 标签 "关联链接：" | 距顶部 10px，左侧 | 字体 14px，黑色 | 无 |
| 链接文本框 | 标签右侧，宽 500px，高 30px | 边框 1px 灰色，字体 12px，背景 #F5F5F5 | 点击 "复制" 按钮复制内容 |
| "复制" 按钮 | 文本框右侧，宽 60px，高 24px | 浅灰底色，字体 12px | 点击提示 "复制成功" |
| 标签 "查询次数：" | 链接文本框下方，距 15px | 字体 14px，黑色 | 无 |
| 次数文本 | 标签右侧 | 字体 14px，加粗，黑色 | 显示 "第 X 次查询" |
| 标签 "核销状态：" | 次数文本下方，距 15px | 字体 14px，黑色 | 无 |
| 状态文本 | 标签右侧 | 未核销：14px 灰色；已核销：14px 绿色（#27AE60） | 无 |
| 标签 "核销时间：" | 状态文本下方，距 15px | 字体 14px，黑色 | 无 |
| 时间文本 | 标签右侧 | 字体 14px，黑色 | 未核销显示 "--"，已核销显示时间 |
| "确认核销" 按钮 | 时间文本下方，距 15px | 未核销：绿色底色（#27AE60），白色字体 13px；已核销：灰色底色，白色字体 13px（置灰） | 未核销点击弹出二次确认，已核销不可点击 |

#### 2.4 历史记录区（底部部分，宽 800px，高 180px，边框 1px 灰色，间距 10px）

| 元素 | 位置 | 样式 | 交互 |
| ---- | ---- | ---- | ---- |
| 标题 "查询历史（最近 100 条）" | 左上角，距顶部 5px | 字体 14px，加粗，黑色 | 无 |
| "清空记录" 按钮 | 右上角，距顶部 5px | 浅红底色（#E74C3C），白色字体 12px，宽 80px，高 25px | 点击弹出 "确认清空？"，确认后删除所有记录 |
| 记录表格 | 标题下方，距 10px，宽 780px，高 130px | 边框 1px 灰色，表头背景 #F5F5F5，字体 12px | 表头：查询时间、指定数字、查询结果、核销状态、操作；操作列含 "重新查询"（浅蓝按钮）、"删除"（浅红按钮） |

### 3. 关键状态样式

#### 3.1 未加载文件夹

- 结果展示区、历史记录区整体置灰（透明度 50%）
- 查询按钮、选择文件夹按钮外的其他按钮不可用

#### 3.2 加载中

- 文件夹配置区的 "重新加载" 按钮显示加载动画（转圈图标）
- 提示文本为 "加载中，请稍候..."

#### 3.3 查询失败

- 结果展示区所有文本字段显示 "--"
- 二维码区域显示灰色提示文字
- "确认核销" 按钮置灰

---

**文档状态**：草稿  
**最后更新**：2025年11月7日  
**版本号**：v1.0

